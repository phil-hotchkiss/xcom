name: Generate ASP.NET Core 8 Server Stub

on:
  push:
    paths:
      - index.yaml  # Run this action when OpenAPI specs change.
  workflow_dispatch:  # Allow manual triggering.

jobs:
  generate-aspnetcore-server:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Generate ASP.NET Core 8 Server Stub
        uses: hatamiarash7/openapi-generator@v0.3.0
        with:
          generator: aspnetcore  # The correct argument for specifying the generator.
          generator-tag: latest  # Version of the generator.
          openapi-file: ./index.yaml  # Path to your OpenAPI spec.
          output-dir: ./server  # Output directory.
          command-args: |  # Additional properties for customization.
            --additional-properties=targetFramework=net8.0
